import{b as y,c as r,d as n,F as g,B as v,f as w,g as x,t as p,e as t,l as b,n as T,V as $,s as S,r as V,z as _,O as f,w as m,W as k,T as B}from"./index-yneSRaZ5.js";import{a as L}from"./tasks-Ry853RJc.js";const C={class:"list-group mb-3"},D={class:"material-symbols-outlined p-1 pe-2 text-primary"},q={__name:"TaskSidebar",setup(i){const u=[{id:1,name:"我的任務",en:"myTasks",path:"/tasks/my",icon:"import_contacts"},{id:0,name:"全任務列表",en:"allTasksList",path:"/tasks",icon:"folder"}];return(d,c)=>{const e=y("RouterLink");return r(),n("div",C,[(r(),n(g,null,v(u,l=>w(e,{key:l.en,to:l.path,class:T(["list-group-item list-group-item-action border-0 rounded-1 d-flex align-items-center",{active:d.$route.path===l.path}])},{default:x(()=>[t("span",D,p(l.icon),1),b(" "+p(l.name),1)]),_:2},1032,["to","class"])),64))])}}},{apiGetTasksFilter:M}=L,H=$("taskStore",{state:()=>({groups:[],tags:[]}),actions:{async getGroupsAndTags(){var i,u,d,c;try{const{filters:e}=await M();this.groups=e.task_groups,this.tags=e.tags}catch(e){S.toastMessage("danger","",`${(u=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:u.statusCode}:${(c=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:c.message}`)}}}}),z={class:"row g-2"},A={class:"col-md-4"},F=t("option",{value:"all"},"全部分類",-1),N=["value"],U={class:"col-md-4"},G=t("option",{value:"all"},"全部課程",-1),O=["value"],R={class:"col-md-4"},E={class:"d-flex align-items-center"},P=["disabled"],I={__name:"Search",props:{groups:{type:Array,default:()=>[]},tags:{type:Array,default:()=>[]}},emits:["search"],setup(i,{emit:u}){const d=u,c=i,e=V({group:"all",tag:"all",keyword:""}),l=_(()=>e.value.tag==="all"?c.groups:c.groups.filter(s=>s.tags.some(o=>o.id===e.value.tag)));f(()=>e.value.tag,()=>{e.value.group="all",e.value.keyword=""});const h=_(()=>{let s="";return e.value.tag!=="all"&&(s+=`task_tag_id=${e.value.tag}&`),e.value.group!=="all"&&(s+=`filter=task_group_id&value=${e.value.group}`),e.value.keyword!==""&&(s+=`&keyword=${e.value.keyword}`),s===""?null:s});return f(()=>e.value,()=>{d("search",h.value)},{deep:!0}),(s,o)=>(r(),n("div",z,[t("div",A,[m(t("select",{"onUpdate:modelValue":o[0]||(o[0]=a=>e.value.tag=a),class:"form-select","aria-label":"Default select example"},[F,(r(!0),n(g,null,v(i.tags,a=>(r(),n("option",{value:a.id,key:a.id},p(a.name),9,N))),128))],512),[[k,e.value.tag]])]),t("div",U,[m(t("select",{"onUpdate:modelValue":o[1]||(o[1]=a=>e.value.group=a),class:"form-select","aria-label":"Default select example"},[G,(r(!0),n(g,null,v(l.value,a=>(r(),n("option",{value:a.id,key:a.id},p(a.name),9,O))),128))],512),[[k,e.value.group]])]),t("div",R,[t("div",E,[m(t("input",{class:"form-control",type:"text",placeholder:"輸入任務名稱搜尋","onUpdate:modelValue":o[2]||(o[2]=a=>e.value.keyword=a),disabled:e.value.group==="all"},null,8,P),[[B,e.value.keyword,void 0,{lazy:!0}]])])])]))}};export{I as _,q as a,H as t};
